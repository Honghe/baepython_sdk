# -*- coding: utf-8 -*-

from django.shortcuts import get_object_or_404, render_to_response
from django.http import HttpResponseRedirect, HttpResponse
from django.core.urlresolvers import reverse
from django.template import RequestContext
from django.shortcuts import render


def index(request):
    return render(request, 'upload/index.html', {})

BCS_HOST="http://bcs.duapp.com"
def upload(request):
    uf = request.FILES.get('file', None)
    data = uf.read()
    name = uf.name
    size = uf.size

    from bae.api.bcs import BaeBCS
    bcs = BaeBCS(host=BCS_HOST)
    bname = "pyupload"
    oname = "/%s" % name.encode('utf8')
    e, d = bcs.put_object(bname, oname, data)
    if e == 0:
        s = "put_object success: (%s) (%d)" % (name, size)
    else:
        s = "put_object failed: " + str(d)
    return HttpResponse(s)
